<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>익스트림 저시력 측정 도구 (Max 800px)</title>
    <style>
        body { background-color: #000; color: #fff; margin: 0; font-family: sans-serif; display: flex; flex-direction: column; height: 100vh; }
        header { background: #1a1a1a; padding: 15px; border-bottom: 2px solid #ff0000; text-align: center; }
        
        /* 테스트 영역: 화면의 대부분을 차지하도록 설정 */
        #test-container { flex: 1; overflow: auto; display: flex; align-items: center; justify-content: center; background: #000; padding: 20px; }
        #sample-text { margin: 0; line-height: 1; word-break: break-all; white-space: pre-wrap; text-align: center; }
        
        .control-panel { background: #222; padding: 20px; border-top: 2px solid #444; }
        .slider-group { margin-bottom: 15px; }
        input[type=range] { width: 80%; height: 30px; }
        .val-display { font-size: 2em; color: #ff0000; font-weight: bold; }
        
        input[type=number] { background: #333; color: #fff; border: 1px solid #ff0000; padding: 10px; width: 80px; font-size: 1.2em; }
        button { padding: 15px 25px; cursor: pointer; background: #ff0000; color: #fff; border: none; border-radius: 8px; font-weight: bold; font-size: 1.1em; margin: 5px; }
        
        .result-bar { background: #111; padding: 10px; color: #00ffcc; font-family: monospace; font-size: 1.1em; }
    </style>
</head>
<body>

<header>
    <strong>[환경 설정]</strong> 
    모니터(인치): <input type="number" id="monitor-size" value="27"> | 
    거리(cm): <input type="number" id="view-dist" value="40"> 
</header>

<div id="test-container">
    <p id="sample-text">가</p>
</div>

<div class="control-panel">
    <div class="slider-group">
        <label>글자 크기 조정: <span id="size-val" class="val-display">24</span> px</label><br>
        <input type="range" id="font-slider" min="10" max="800" value="24" step="2">
    </div>
    
    <div>
        <button onclick="changeText('가')">한 글자(가)</button>
        <button onclick="changeText('가나다라마')">짧은 문장</button>
        <button onclick="changeBg('#000', '#fff')">흑색 배경</button>
        <button onclick="changeBg('#fff', '#000')">백색 배경</button>
        <button onclick="changeBg('#ff0', '#000')">고대비(황/흑)</button>
        <button onclick="copyData()" style="background:#00ffcc; color:#000;">데이터 복사</button>
    </div>
    
    <div id="reaction-section" style="margin-top:20px; padding-top:10px; border-top:1px solid #444;">
        <button id="reaction-btn" onclick="startReaction()" style="background:#444; width:100%;">반응속도 테스트 (클릭하여 시작)</button>
    </div>
</div>

<div class="result-bar" id="final-summary">
    데이터 대기 중...
</div>

<script>
    const slider = document.getElementById('font-slider');
    const text = document.getElementById('sample-text');
    const sizeVal = document.getElementById('size-val');
    const summary = document.getElementById('final-summary');
    const rBtn = document.getElementById('reaction-btn');

    let startTime, timer;
    let rTimes = [];

    slider.oninput = function() {
        text.style.fontSize = this.value + 'px';
        sizeVal.innerText = this.value;
        updateSummary();
    }

    function changeText(str) { text.innerText = str; updateSummary(); }
    
    function changeBg(bg, color) {
        document.getElementById('test-container').style.backgroundColor = bg;
        text.style.color = color;
    }

    function startReaction() {
        if (rBtn.style.background === 'red' || rBtn.style.background === 'green') return;
        rBtn.style.background = 'red'; rBtn.innerText = '대기...';
        const delay = Math.random() * 2000 + 2000;
        timer = setTimeout(() => {
            rBtn.style.background = 'green'; rBtn.innerText = '지금!!';
            startTime = Date.now();
        }, delay);
    }

    rBtn.onmousedown = function() {
        if (this.style.background === 'green') {
            const diff = Date.now() - startTime;
            rTimes.push(diff);
            const avg = (rTimes.reduce((a, b) => a + b) / rTimes.length).toFixed(0);
            this.innerText = `성공! ${diff}ms (평균: ${avg}ms)`;
            this.style.background = '#444';
            updateSummary();
        }
    }

    function updateSummary() {
        const data = {
            res: `${window.screen.width}x${window.screen.height}`,
            monitor: document.getElementById('monitor-size').value,
            dist: document.getElementById('view-dist').value,
            font: slider.value,
            reaction: rTimes.length > 0 ? (rTimes.reduce((a,b)=>a+b)/rTimes.length).toFixed(0) : "-"
        };
        summary.innerText = `[JSON 데이터] {"res":"${data.res}", "monitor":"${data.monitor}in", "dist":"${data.dist}cm", "font":"${data.font}px", "reaction":"${data.reaction}ms"}`;
    }

    function copyData() {
        navigator.clipboard.writeText(summary.innerText);
        alert('데이터가 복사되었습니다.');
    }

    window.onload = updateSummary;
</script>
</body>
</html>
