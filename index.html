<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>환경 보정형 가독성 측정 도구</title>
    <style>
        body { background-color: #121212; color: white; font-family: sans-serif; text-align: center; padding: 20px; }
        .env-panel { background: #222; padding: 15px; border-radius: 10px; margin-bottom: 20px; border: 1px solid #444; }
        #test-area { margin: 30px auto; padding: 40px; border: 2px dashed #444; min-height: 250px; display: flex; align-items: center; justify-content: center; background: #000; overflow: hidden; position: relative;}
        .controls { background: #222; padding: 20px; border-radius: 10px; display: inline-block; width: 80%; }
        input[type=range] { width: 100%; }
        input[type=number] { background: #444; color: #fff; border: 1px solid #666; padding: 5px; width: 60px; }
        .result-box { margin-top: 20px; color: #00ffcc; font-weight: bold; background: #1a1a1a; padding: 15px; border-radius: 8px; }
        button { padding: 10px 20px; cursor: pointer; background: #00ffcc; border: none; border-radius: 5px; font-weight: bold; margin: 5px; }
        #reaction-area { width: 100%; height: 150px; background: #444; margin-top: 20px; display: flex; align-items: center; justify-content: center; cursor: pointer; border-radius: 10px; font-weight: bold; }
    </style>
</head>
<body>
    <h1>게임 접근성 가독성 & 반응속도</h1>

    <div class="env-panel">
        <strong>환경 보정:</strong> 
        모니터 크기(인치): <input type="number" id="monitor-size" value="27"> | 
        시청 거리(cm): <input type="number" id="view-dist" value="60">
    </div>

    <div class="controls">
        <h3>1. 가독성 측정</h3>
        <p>슬라이더를 조절해 <b>가장 작지만 읽을 수 있는 크기</b>를 찾으세요.</p>
        <label>현재 폰트 크기: <span id="size-val" style="color:#00ffcc; font-size:1.2em;">24</span> px</label><br>
        <input type="range" id="font-slider" min="8" max="100" value="24">
        <br><br>
        <button onclick="changeBg('#000', 'white')">Black</button>
        <button onclick="changeBg('#fff', 'black')">White</button>
        <input type="file" id="bg-upload" accept="image/*" style="display:none">
        <button onclick="document.getElementById('bg-upload').click()" style="background:#666; color:white;">게임 스크린샷 업로드</button>
        
        <div id="test-area">
            <p id="sample-text">다람쥐 헌 쳇바퀴에 타고파. The quick brown fox jumps over the lazy dog. 1234567890</p>
        </div>
    </div>

    <div class="controls" style="margin-top:20px;">
        <h3>2. 기초 반응 속도</h3>
        <div id="reaction-area">클릭하여 시작 (빨간색 -> 초록색 변할 때 클릭!)</div>
        <p id="reaction-result">평균 반응 속도: - ms</p>
    </div>

    <div class="result-box">
        <div id="final-summary">데이터가 여기에 표시됩니다.</div>
        <button onclick="copyResult()" style="margin-top:10px;">결과 전체 복사하기</button>
    </div>

    <script>
        const slider = document.getElementById('font-slider');
        const text = document.getElementById('sample-text');
        const sizeVal = document.getElementById('size-val');
        const testArea = document.getElementById('test-area');
        const rArea = document.getElementById('reaction-area');
        const rRes = document.getElementById('reaction-result');

        let startTime, timer;
        let reactionTimes = [];

        // 폰트 조절
        slider.oninput = function() {
            text.style.fontSize = this.value + 'px';
            sizeVal.innerText = this.value;
            updateSummary();
        }

        function changeBg(bg, color) {
            testArea.style.backgroundImage = 'none';
            testArea.style.backgroundColor = bg;
            text.style.color = color;
        }

        document.getElementById('bg-upload').onchange = function(e) {
            const reader = new FileReader();
            reader.onload = (event) => {
                testArea.style.backgroundImage = `url(${event.target.result})`;
                testArea.style.backgroundSize = 'cover';
            };
            reader.readAsDataURL(e.target.files[0]);
        }

        // 반응속도 로직
        rArea.onclick = function() {
            if (this.style.background === 'rgb(68, 68, 68)' || this.style.background === '') {
                this.style.background = 'red'; this.innerText = '대기...';
                const delay = Math.random() * 2000 + 2000;
                timer = setTimeout(() => {
                    this.style.background = 'green'; this.innerText = '지금!!';
                    startTime = Date.now();
                }, delay);
            } else if (this.style.background === 'green') {
                const diff = Date.now() - startTime;
                reactionTimes.push(diff);
                const avg = (reactionTimes.reduce((a, b) => a + b) / reactionTimes.length).toFixed(0);
                rRes.innerText = `평균 반응 속도: ${avg}ms (시도: ${reactionTimes.length}회)`;
                this.style.background = '#444'; this.innerText = '다시 시작하려면 클릭';
                updateSummary();
            }
        }

        function updateSummary() {
            const summary = {
                res: `${window.screen.width}x${window.screen.height}`,
                monitor: document.getElementById('monitor-size').value + "인치",
                dist: document.getElementById('view-dist').value + "cm",
                minFont: slider.value + "px",
                avgReaction: rRes.innerText.split(': ')[1] || "-"
            };
            document.getElementById('final-summary').innerText = 
                `[결과] 해상도: ${summary.res} | 모니터: ${summary.monitor} | 거리: ${summary.dist} | 폰트: ${summary.minFont} | 반응: ${summary.avgReaction}`;
        }

        function copyResult() {
            const text = document.getElementById('final-summary').innerText;
            navigator.clipboard.writeText(text);
            alert('복사 완료! 엑셀이나 AI에게 전달하세요.');
        }

        window.onload = updateSummary;
    </script>
</body>
</html>
