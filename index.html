<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>저시력 특화 가독성 측정 도구</title>
    <style>
        body { background-color: #121212; color: white; font-family: sans-serif; text-align: center; padding: 20px; margin: 0; }
        .env-panel { background: #222; padding: 15px; border-radius: 10px; margin-bottom: 20px; border: 1px solid #444; sticky; top: 0; z-index: 100; }
        
        /* 테스트 영역 개선: 글자가 커져도 스크롤로 확인 가능 */
        #test-area { 
            margin: 20px auto; 
            padding: 20px; 
            border: 3px solid #00ffcc; 
            min-height: 400px; 
            max-height: 60vh;
            display: block; 
            background: #000; 
            overflow: auto; 
            text-align: left;
            word-break: break-all; /* 긴 단어도 줄바꿈 */
        }
        
        #sample-text { margin: 0; line-height: 1.2; transition: font-size 0.1s; }
        
        .controls { background: #222; padding: 20px; border-radius: 10px; display: inline-block; width: 90%; max-width: 1000px; }
        
        /* 슬라이더 디자인 강조 */
        input[type=range] { width: 100%; height: 25px; cursor: pointer; }
        input[type=number] { background: #444; color: #fff; border: 1px solid #666; padding: 8px; width: 80px; font-size: 1.1em; }
        
        .result-box { margin-top: 20px; color: #00ffcc; font-weight: bold; background: #1a1a1a; padding: 20px; border-radius: 8px; border: 2px solid #00ffcc; }
        button { padding: 12px 24px; cursor: pointer; background: #00ffcc; border: none; border-radius: 5px; font-weight: bold; margin: 5px; font-size: 1em; }
        #reaction-area { width: 100%; height: 120px; background: #444; margin-top: 20px; display: flex; align-items: center; justify-content: center; cursor: pointer; border-radius: 10px; font-weight: bold; font-size: 1.2em; }
    </style>
</head>
<body>
    <h1>장애인 게이머 가독성 측정 (저시력 모드)</h1>

    <div class="env-panel">
        <strong>환경 보정 데이터:</strong> 
        모니터 크기(인치): <input type="number" id="monitor-size" value="27"> | 
        시청 거리(cm): <input type="number" id="view-dist" value="60">
    </div>

    <div class="controls">
        <h3>1. 폰트 크기 측정 (Range: 8px - 300px)</h3>
        <p>글자가 <b>확실히 보이고 읽을 수 있는 최소 크기</b>를 찾으세요.</p>
        
        <div style="font-size: 1.5em; margin-bottom: 10px;">
            현재 폰트 크기: <span id="size-val" style="color:#00ffcc; font-weight:bold; font-size:1.5em;">24</span> px
        </div>
        
        <input type="range" id="font-slider" min="8" max="300" value="24" step="1">
        
        <br><br>
        <button onclick="changeBg('#000', 'white')">검은 배경</button>
        <button onclick="changeBg('#fff', 'black')">흰색 배경</button>
        <input type="file" id="bg-upload" accept="image/*" style="display:none">
        <button onclick="document.getElementById('bg-upload').click()" style="background:#555; color:white;">게임 스크린샷 업로드 테스트</button>
        
        <div id="test-area">
            <p id="sample-text">가나다라마바사 ABCDEFG 12345</p>
        </div>
    </div>

    <div class="controls" style="margin-top:20px;">
        <h3>2. 기초 반응 속도</h3>
        <div id="reaction-area">이곳을 클릭하여 반응속도 측정 시작</div>
        <p id="reaction-result" style="font-size: 1.2em;">평균 반응 속도: - ms</p>
    </div>

    <div class="result-box">
        <div id="final-summary" style="font-size: 1.1em;">설정을 조절하면 결과가 업데이트됩니다.</div>
        <button onclick="copyResult()" style="background:#fff; color:#000; margin-top:15px; font-size:1.2em;">결과 전체 복사하기</button>
    </div>

    <script>
        const slider = document.getElementById('font-slider');
        const text = document.getElementById('sample-text');
        const sizeVal = document.getElementById('size-val');
        const testArea = document.getElementById('test-area');
        const rArea = document.getElementById('reaction-area');
        const rRes = document.getElementById('reaction-result');

        let startTime, timer;
        let reactionTimes = [];

        // 폰트 크기 조절
        slider.oninput = function() {
            text.style.fontSize = this.value + 'px';
            sizeVal.innerText = this.value;
            updateSummary();
        }

        function changeBg(bg, color) {
            testArea.style.backgroundImage = 'none';
            testArea.style.backgroundColor = bg;
            text.style.color = color;
        }

        document.getElementById('bg-upload').onchange = function(e) {
            const reader = new FileReader();
            reader.onload = (event) => {
                testArea.style.backgroundImage = `url(${event.target.result})`;
                testArea.style.backgroundSize = 'cover';
                testArea.style.backgroundPosition = 'center';
            };
            reader.readAsDataURL(e.target.files[0]);
        }

        // 반응속도 로직
        rArea.onclick = function() {
            if (this.style.background === 'rgb(68, 68, 68)' || this.style.background === '' || this.innerText.includes('다시')) {
                this.style.background = 'red'; this.innerText = '대기...';
                const delay = Math.random() * 2000 + 2000;
                timer = setTimeout(() => {
                    this.style.background = 'green'; this.innerText = '지금 클릭!!';
                    startTime = Date.now();
                }, delay);
            } else if (this.style.background === 'green') {
                const diff = Date.now() - startTime;
                reactionTimes.push(diff);
                const avg = (reactionTimes.reduce((a, b) => a + b) / reactionTimes.length).toFixed(0);
                rRes.innerText = `평균 반응 속도: ${avg}ms (시도: ${reactionTimes.length}회)`;
                this.style.background = '#444'; this.innerText = '성공! 다시 시작하려면 클릭';
                updateSummary();
            }
        }

        function updateSummary() {
            const summary = {
                res: `${window.screen.width}x${window.screen.height}`,
                monitor: document.getElementById('monitor-size').value + "인치",
                dist: document.getElementById('view-dist').value + "cm",
                minFont: slider.value + "px",
                avgReaction: rRes.innerText.includes('-') ? "-" : rRes.innerText.split(': ')[1]
            };
            document.getElementById('final-summary').innerText = 
                `[최종 데이터] 해상도: ${summary.res} | 모니터: ${summary.monitor} | 시청거리: ${summary.dist} | 임계폰트: ${summary.minFont} | 반응속도: ${summary.avgReaction}`;
        }

        function copyResult() {
            const resultText = document.getElementById('final-summary').innerText;
            navigator.clipboard.writeText(resultText);
            alert('데이터가 복사되었습니다!');
        }

        window.onload = updateSummary;
        // 환경 설정 값이 바뀔 때도 업데이트
        document.getElementById('monitor-size').onchange = updateSummary;
        document.getElementById('view-dist').onchange = updateSummary;
    </script>
</body>
</html>
